EMD, 경험적 모드 분해법은 시계열 신호를 분석하기 위한 것으로, 파라미터 값을 정의하지 않고 원 신호 (raw signal)에 기반하여 분해되는 방법이다.

- 이는 원 신호 (raw signal)의 비선형적 (non-linear), 비정형적인 (non-stationary) 특징이 보존된다 (원 신호가 선형인지, 비선형인지 고려할 필요가 없음)
- EMD 알고리즘을 이용하여 원 신호 (raw signal)이 *n* 개의 IMF (Intrinsic mode functions, 고유진동함수)들과 residue로 분해된다

우리가 앞으로 다루게 될 모든 시계열 데이터는 수 많은 요소가 포함되었기에 복잡하다. 예를 들어 날씨만 보더라도 기상 차트를 분석할 때는 계절 변화, 글로벌워밍, 저기압, 고기압 탄소배출량 등등 너무 고려해야 할 것도 많은데, 하필 그 요소들이 죄다 데이터 하나에 압축되어 있다. 심지어 그중에는 그냥 심심해서 일시적으로 나타났다 사라지는것도 존재한다.

우리가 어떤 데이터에서 특정 데이터를 추론하기 위해서는 (예를 들어, 기상 차트에서 계절 변화를 보기 위한것) 신호를 분리해야한다.

그럼 어떻게 분해할까?

### 1. 분해

---

특정 시퀀스에 실제로 적용할 수 있는 분해 방법은 다양하다. 경험적, 수학적등등 방법은 많다. 하지만, 가장 간단한 분해 방법은 잘 알려진 여러 방법을 이용해 시퀀스를 몇 가지 요소 나누는 것이다.

![Pasted image 20240821104235.png](Pasted_image_20240821104235.png)

> MA(이동 평균선)이란, 가격 데이터를 평활화 하여 추세를 파악하고 트레이딩 진입과 청산 지점을 확인하는데 이용되는 기술 분석 도구이다.
> 

예를 들어, 임의의 통화쌍 차트에 MA(이동 평균)를 그려보자. MA 곡선을 초기 시퀀스에서 제외한다. 그 결과 초기 시퀀스의 두 요소, MA 곡선과 잔차가 남게 된다.

![Pasted image 20240821104410.png](Pasted_image_20240821104410.png)

이렇게 나온 잔차에 보다 긴 기간을 갖는 MA를 이용해 동일한 과정을 적용하면 세 가지 요소가 나온다. 두 개의 MA 곡선과 변형 잔차이다.

이렇듯 분해는 아주 쉽게 이루어질 수 있다. 중요한 건 해당 과정에서 나온 결과의 특성을 파악해야 한다는 것이다.

잘 알려진 분해 및 스펙트럼 분석 방법 중에 너무나도 친숙한 푸리에 변환이 있다.

푸리에 변환은 기저 함수를 이용한 직교 변환의 일종이다. (이에 대한 자세한 정의와 유도 방법은 공학수학 2를 참고하자, 간단히 설명하자면 sin과 cos의 직교성을 이용해서 정의했다. )

푸리에 변환의 결과로 초기 프로세스가 고정된 주파수와 진폭을 갖는 기저 함수로 분해된다. 그렇기에 특히 주의할 점이 두 가지가 있다.

1. 푸리에 변환은 반드시 기존에 정해진 직교 함수를 이용해야 한다. 따라서 기저 변환과 변환된 시퀀스의 특성은 서로 무관하게 된다.
2. 결과가 되는 고조파의 진폭과 주파수는 불변성을 갖는다. 초기 시퀀스 전반에 걸쳐 동일한 값을 갖는다. 다시 말해 초기 시퀀스의 특성이 특정 구간에서 변한다고 해도 변환 결과는 동일하게 나타난다. 이 경우 해당 결과는 프로세스 내 특정한 평균적 상태만을 반영하게 된다. (초기 데이터의 정상성을 가정하기에 )

초기 시퀀스의 비정상성과 관련된 제약을 피하기 위해 푸리에 변환 대신 웨이블릿 변환을 이용할 수 있다. 푸리에 변환과 마찬가지로 웨이블릿 변환은 고정된 기저 함수를 이용해 분해를 실행한다. 푸리에 변환과는 달리 웨이블릿이 생성한 기저 함수가 사용된다.

또한 웨이블릿 변환의 결과가 되는 모든 요소는 시간의 변화에 따른 각 요소의 스케일과 레벨을 결정하는 매개 변수를 가진다. 그렇기에 분석된 프로세스의 비정상성과 관련된 문제가 해결된다.

푸리에 변환과 웨이블릿 변환 모두 효과적인 알고리즘을 이용한, 현대 수학에서 폭넓게 적용되는 테크닉이다. 게다가 적용 가능한 분야도 다양하다.

근데 푸리에 변환과 웨이블릿 변환의 장점을 모두 가진 변환 방법이 있다.

### 2. 경험적 모드 분해

---

경험적 모드 분해(EMD)는 힐베르트-황 변환(HHT)의 핵심이다. 힐베르트-황 변환은 두 가지 단계로 나눌 수 있다.

1. EMD
	첫 번째 단계에서는 **경험적 모드 분해(EMD)** 를 사용하여 신호를 여러 개의 **내재 모드 함수(IMF)** 로 나눈다. 이 IMF는 신호를 구성하는 기본적인 진동 성분으로 볼 수 있다.
    
    EMD는 신호를 분해할 때, 다음 두 가지 조건을 만족하는 IMF를 찾는다
    
    - **극값(최대값과 최소값)의 개수와 제로 크로싱의 개수**가 비슷해야 한다. 제로 크로싱은 신호가 0을 통과하는 횟수이다.
    - **극대 포락선과 극소 포락선의 평균 값이 0**이 되어야 한다.
    
    이 과정을 통해 신호가 여러 개의 IMF로 분해되며, 각 IMF는 원래 신호에서 다른 주파수 성분을 나타낸다. 예를 들어, 첫 번째 IMF는 가장 빠른 진동을, 두 번째 IMF는 그보다 느린 진동을 나타내며, 이런 식으로 주파수가 점점 낮아진다.
    
    쉽게 풀어 쓰면 **EMD**는 신호를 여러 개의 작은 파동(진동)으로 나누는 과정이다
    
2. 힐베르트 변환
	두 번째 단계에서는 각 IMF에 **힐베르트 변환**을 적용한다. 이 변환은 각 IMF의 **순간 주파수**를 계산한다. 순간 주파수는 신호가 시간에 따라 어떻게 변하는지를 보여준다.
    
    힐베르트 변환을 통해 얻은 정보는 신호의 주파수와 진폭이 시간에 따라 어떻게 변화하는지를 자세히 보여준다. 이 방법은 특히 신호가 일정하지 않고, 시간이 지나면서 크게 변하는 경우에 유용하다.
    
    쉽게 풀어 쓰면, **힐베르트 변환**은 EMD의 작은 파동들이 시간에 따라 어떻게 변하는지를 보여준다.
    

분해 결과는 주파수의 정도에 따라 내재 모드 함수 요소로 나타난다. 다음 내재 모드 함수는 항상 이전의 내재 모드 함수보다 낮은 주파수 진동을 갖는다.

내재 모드 함수에 진동하는 특성이 있긴 하지만 시간축을 따라 변동이 매우 심한 진폭과 주파수를 가질 수 있다.

### 3. EMD 알고리즘

---

경험적 모드 분해(EMD)는 신호를 여러 개의 내재 모드 함수(IMF)로 분해하는 과정이다. 이 알고리즘은 시퀀스의 최대값과 최소값을 이용해 포락선을 생성하고, 이를 통해 신호를 점차적으로 분해해 나간다.

황의 알고리즘은 시퀀스의 최대값과 최소값을 이용한 포락선 생성과 초기 시퀀스에서 해당 포락선의 평균을 제외하는 것을 기반으로 한다. 상단과 하락 포락선을 구하려면 전체 극단값을 구해 스플라인 곡선으로 연결해야 한다.

![Pasted image 20240821105616.png](Pasted_image_20240821105616.png)

두 포락선의 평균은 점선으로 나타난다. 해당 평균은 초기 시퀀스에서 제외된다.

그 다음에 시프팅이라는 과정을 거쳐야 한다.

시프팅(Shifting) 과정

1. **평균값 제거**: 원래 신호(파란색 선)에서 위에서 계산된 평균선(점선)을 뺀다. 이렇게 하면 신호의 고주파 성분이 제거되어 첫 번째 추정값이 만들어진다. 이 과정은 신호에서 불필요한 변동을 제거하고, 중요한 진동 패턴만 남기기 위한 것이다.
2. **반복**: 이 과정을 반복하여 새로운 최대값과 최소값을 찾고, 다시 포락선을 생성한 뒤 평균선을 구한다. 이렇게 평균선을 제거하는 작업을 계속 반복하여 신호가 더 이상 변하지 않거나 IMF의 조건을 만족할 때까지 시프팅을 반복한다.
3. **IMF 추출**: 시프팅 과정이 완료되면 첫 번째 IMF가 추출된다. 이 IMF는 원래 신호에서 빠른 진동 성분을 나타낸다. 이후, 원래 신호에서 이 IMF를 제거하고, 나머지 신호에 대해 동일한 과정을 반복하여 다음 IMF를 추출한다.

경험적 모드 분해 과정은 철저하게 수학적 연산을 따른다기 보다는 정말 말 그대로 경험을 따른다고 볼 수 있다.

### 4. EEMD (Ensemble Empirical Mode Decomposition)

---

**집합 경험적 모드 분해(Ensemble Empirical Mode Decomposition, EEMD)** 는 기본 **경험적 모드 분해(EMD)** 방법의 확장된 버전이다. EEMD는 EMD의 몇 가지 단점을 보완하기 위해 개발된 기법으로, 특히 EMD가 본질적으로 비선형적이고 비정상적인 신호를 분해하는 데 있어서 발생할 수 있는 모드 혼합 문제를 해결하는 데 중점을 둔다.

### 1. EMD의 한계와 EEMD의 필요성

기본 EMD는 신호를 여러 내재 모드 함수(IMF)로 분해하는 과정에서, 모드 혼합(Mode Mixing)이라는 문제가 발생할 수 있다. 모드 혼합이란 서로 다른 주파수 성분이 하나의 IMF에 섞여 있거나, 하나의 주파수 성분이 여러 IMF에 걸쳐 나뉘는 현상을 말한다. 이는 EMD의 결과의 해석을 어렵게 하고, 신호의 실제 성분을 정확히 분리하지 못하는 문제를 초래할 수 있다.

### 2. EEMD의 원리와 과정

EEMD는 이러한 문제를 해결하기 위해 신호에 여러 번의 백색 잡음(white noise)을 추가한 후 EMD를 수행하는 방식으로 작동한다.

1. **잡음 추가**: 원래 신호에 작은 크기의 백색 잡음을 추가한다. 이 잡음은 무작위적이어서 신호의 모든 주파수 성분에 고르게 퍼져 있다.
2. **EMD 수행**: 잡음이 추가된 신호에 대해 EMD를 수행하여 IMF를 추출한다.
3. **반복**: 위 과정을 여러 번 반복한다. 각 반복마다 다른 백색 잡음을 추가하여 신호를 변형한 후 EMD를 적용한다.
4. **IMF 평균 계산**: 반복적으로 얻어진 각 IMF들을 평균 내어 최종 IMF를 얻는다. 이렇게 하면 잡음에 의해 생긴 불필요한 성분이 상쇄되고, 신호의 본래 성분만이 남게 된다.

### 3. EEMD의 장점

- **모드 혼합 문제 해결**: EEMD는 다양한 잡음 신호에 대해 반복적으로 IMF를 계산하고, 그 결과를 평균내기 때문에 모드 혼합 문제를 효과적으로 해결할 수 있다.
- **더 안정적인 결과**: 원래 신호의 작은 변동이나 잡음에 덜 민감하게 반응하기 때문에 EMD보다 더 안정적이고 신뢰성 있는 결과를 얻을 수 있다.